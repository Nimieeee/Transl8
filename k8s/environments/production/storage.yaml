apiVersion: v1
kind: Secret
metadata:
  name: s3-credentials
  namespace: production
type: Opaque
stringData:
  AWS_ACCESS_KEY_ID: REPLACE_WITH_ACTUAL_KEY
  AWS_SECRET_ACCESS_KEY: REPLACE_WITH_ACTUAL_SECRET
  AWS_REGION: us-east-1
  S3_BUCKET_NAME: dubbing-platform-production
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: storage-config
  namespace: production
data:
  STORAGE_PROVIDER: s3
  S3_ENDPOINT: https://s3.amazonaws.com
  FILE_RETENTION_DAYS: "30"
  MAX_FILE_SIZE: "524288000"  # 500MB
  S3_LIFECYCLE_ENABLED: "true"
---
# S3 Lifecycle Policy (apply via AWS CLI or Console)
# This is documentation, not a Kubernetes resource
#
# aws s3api put-bucket-lifecycle-configuration \
#   --bucket dubbing-platform-production \
#   --lifecycle-configuration file://s3-lifecycle.json
#
# s3-lifecycle.json:
# {
#   "Rules": [
#     {
#       "Id": "DeleteOldVideos",
#       "Status": "Enabled",
#       "Filter": {
#         "Prefix": "videos/"
#       },
#       "Expiration": {
#         "Days": 30
#       }
#     },
#     {
#       "Id": "TransitionToIA",
#       "Status": "Enabled",
#       "Filter": {
#         "Prefix": "videos/"
#       },
#       "Transitions": [
#         {
#           "Days": 7,
#           "StorageClass": "STANDARD_IA"
#         }
#       ]
#     },
#     {
#       "Id": "DeleteOldBackups",
#       "Status": "Enabled",
#       "Filter": {
#         "Prefix": "backups/"
#       },
#       "Expiration": {
#         "Days": 90
#       }
#     }
#   ]
# }
